<app-header-common></app-header-common>
<div class="main-content shop-page main-content-grid">
		<div class="container">
			<div class="breadcrumbs">
				<a href="user/account">My Account</a>
			</div>
			<div class="row">
				<div class="col-xs-12 col-sm-7 col-md-8 col-lg-9 content-offset">
					<div class="categories-content">
						<h4 class="shop-title">Create Ad</h4>
                        <div class="row content-form ">


                                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 info-content">
                                    <form [formGroup]="newadForm" class="addnewproduct register-form" (ngSubmit)="addnewproduct(templatenewaddposted)">
                                    <div class="contact-form">
                                        <h4 class="main-title">Product Details</h4>
                                        <h5 class="note-title">( * ) Required fields</h5>
                                        <div class="row">
                                                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                                        <span class="label-text">Category <span>*</span></span>
                                                        <ng-select [searchable]="false" #categorySelect [items]="mainCats" [selectOnTab]="true" bindLabel="catname" bindValue="_id"
												 placeholder="Select category" formControlName="category" (change)="getSubcatList($event._id)">
                                                </ng-select>
                                                <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                    <div *ngIf="newadForm.controls['category'].pristine && newadForm.controls['category'].errors.required">Category is required.</div>
                                                  </div>
                                                    </div>
                                                    <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                                            <span class="label-text">Sub Category <span>*</span></span>
                                                            <ng-select [searchable]="false" #cropsSelect [items]="subCats" [selectOnTab]="true" bindLabel="subcatname" bindValue="_id"
												 placeholder="Select subcategory" formControlName="subcatnames" (change)="getSubcatimages($event)">
                                                </ng-select>
                                                <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                        <div *ngIf="newadForm.controls['subcatnames'].pristine && newadForm.controls['subcatnames'].errors.required">Subcategory is required.</div>
                                                      </div>
                                                        </div>
                                        </div>
                                        <div class="row">
                                            <!-- <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                                                <span class="label-text">Crop</span>
                                                <ng-select [searchable]="false"  #cropsSelect [items]="crops"
                                                        [selectOnTab]="true"
                                                        bindLabel="cropname"
                                                        bindValue="_id"
                                                        placeholder="Select crop"
                                                        formControlName="crop">
                                                        </ng-select>
                                            </div> -->
                                            <div class="col-xs-12 ">
                                                <span class="label-text">Region <span>*</span></span>

                                                        <ng-select [searchable]="false"  #regionSelect [items]="regions"
                                                        [selectOnTab]="true"
                                                        bindLabel="regionname"
                                                        bindValue="_id"
                                                        placeholder="Select region"
                                                        formControlName="region">
                                                      </ng-select>
                                                      <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                            <div *ngIf="newadForm.controls['region'].pristine && newadForm.controls['region'].errors.required">Region is required.</div>
                                                          </div>

                                            </div>
                                        </div>
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
                                                    <span class="label-text">Name <span>*</span></span>
                                                    <input type="text" class="input-info"  formControlName="productname">
                                                    <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                            <div *ngIf="newadForm.controls['productname'].pristine && newadForm.controls['productname'].errors?.required">Name is required.</div>
                                                            <div *ngIf="newadForm.controls['productname'].dirty && newadForm.controls['productname'].errors?.required">Name is required.</div>
                                                          </div>
                                                          <!-- <div *ngIf="newadForm.controls['productname'].errors && !newadForm.controls['productname'].pristine" class="error-msg">
                                                                <div [hidden]="!newadForm.controls['productname'].errors.required">Name is required.</div>
                                                              </div> -->
                                            </div>

                                        </div>
                         
                                        <div class="row">
                                            <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 tsidebar">
                                                <span class="label-text">Price Negotiable</span>
                                                <div class="widget widget-categories">
                                                    <ul class="list-categories">
                                                        <li><input type="radio" id="r1" [checked]= "pricetypeyes"  value="true" formControlName="pricetype"><label for="r1" class="label-text">Yes</label></li>
                                                        <li><input type="radio" id="r2"  [checked]= "pricetypeno" value="false" formControlName="pricetype"><label for="r2" class="label-text">No</label></li>
                                                       </ul>
                                                </div>
                                              
                                            </div>
                                        
                                        </div>
                                        <div class="row">
                                                <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                                        <span class="label-text">Amount For Sale <span>*</span></span>
                                                        <input type="number" class="input-info"  formControlName="saleamount">
                                                        <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                                <div *ngIf="newadForm.controls['saleamount'].pristine && newadForm.controls['saleamount'].errors.required">Amount For Sale is required.</div>
                                                                <div *ngIf="newadForm.controls['saleamount'].dirty && newadForm.controls['saleamount'].errors?.required">Amount For Sale is required.</div>
                                                              </div>
                                                </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                                        <span class="label-text">Amount Unit <span>*</span></span>
                                                        <ng-select [searchable]="false"  #amountforsale [items]="amtforsale"
                                                        [selectOnTab]="true"
                                                        bindLabel="amountunit"
                                                        bindValue="_id"
                                                        placeholder="Select Amount Unit"
                                                        formControlName="amtunit">
                                                    </ng-select>
                                                    <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                            <div *ngIf="newadForm.controls['amtunit'].pristine && newadForm.controls['amtunit'].errors.required">Amount Unit is required.</div>
                                                          </div>
                                                    </div>
                                                <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4">
                                                        <span class="label-text">Price Per Unit <span>*</span></span>
                                                        <input type="number" class="input-info"  formControlName="unitprice">
                                                        <div *ngIf="!newadForm.valid && forcevalidation" class="error-msg">
                                                                <div *ngIf="newadForm.controls['unitprice'].pristine && newadForm.controls['unitprice'].errors.required">Price Per Unit is required.</div>
                                                                <div *ngIf="newadForm.controls['unitprice'].dirty && newadForm.controls['unitprice'].errors?.required">Price Per Unit is required.</div>
                                                              </div>
                                                </div>
                                        </div>


                                    </div>
                                    <div class="group-button">
                                            <button href="#" class="button submit" >
                                                    <span *ngIf="updatingstatus">Updating...</span>
                                                    <span *ngIf="!updatingstatus">Submit</span>
                                                </button>
                                          </div>

                                </form>
                                <!-- <div class="alert alert-success" role="alert" *ngIf="uploadsuccess">
                                        <strong>New Ad : </strong> New Ad Posted Successfully
                                    </div> -->
                                </div>
                                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 map-content" *ngIf="!!defaultproductimage">
                                    <div *ngIf="!uploader?.queue?.length">
                                            <h3>Current product image</h3>
                                            <!-- <small>If you dont' have product image then this will the default products image.</small> -->
                                            <img src="{{defaultproductimage}}" alt="default product image">
                                    </div>

                                   
                                   


                                    <!-- <input type="file" name="file" ng2FileSelect [uploader]="uploader"  *ngIf="uploader?.queue?.length < 1"/> -->
                                    <div class="dottedborder file" *ngIf="!uploader?.queue?.length">
                                            <h5 class="note-title note-bg ">Upload product image (Allowed Extension: .jpg) <br /> Maximum allowed image file size is <strong>300 KB</strong></h5>
                                        <div class="iconblk fileuploadclr">
                                            <i class="fa fa-file-image-o" aria-hidden="true"></i>
                                        </div>
                                        <div class="browsebtn">
                                            <label class="file-upload btn btn-success">
                                                I want to upload my product image <input type="file" id="file" uploader="uploader" (change)="onSelectChange($event, template, templateproductimg)" />
                                                <!--  Browse ... <input type="file" id="file" uploader="uploader" multiple (change)="onSelectChange($event)" /> -->
                                            </label>
                                        </div>
                                    </div>
                                   <!-- fileupload ui -->
                                   <div class="row" *ngIf="uploader?.queue?.length">
                                    <div class="col-lg-12" style="margin-bottom: 40px">
                                        <!-- <p>File in Queue: {{ uploader.queue.length }}</p> -->
                                        <table class="table uploadlisting">
                                          <thead>
                                            <tr>
                                              <th width="50%">Name</th>
                                              <!-- <th ng-show="uploader.isHTML5">Size</th> -->
                                              <th ng-show="uploader.isHTML5">Progress</th>
                                              <th>Status</th>
                                              <th>Actions</th>
                                            </tr>
                                          </thead>
                                          <tbody>
                                            <tr *ngFor="let item of uploader.queue; let i = index">
                                              <td>
                                                  
                                                <strong>{{ item.file.name }}</strong>
                                                <!-- Image preview -->
                                                <!--auto height-->
                                                <!--<div ng-thumb="{ file: item.file, width: 100 }"></div>-->
                                                <!--auto width-->
                                                <div ng-show="uploader.isHTML5" ng-thumb="{ file: item._file, height: 100 }"></div>
                                                <!--fixed width and height -->
                                                <!--<div ng-thumb="{ file: item.file, width: 100, height: 100 }"></div>-->
                                              </td>
                                              <!-- <td ng-show="uploader.isHTML5" nowrap>{{ item.file.size/1024/1024 | number }} MB</td> -->
                                              <td ng-show="uploader.isHTML5">
                                                <div class="progress" style="margin-bottom: 0;">
                                                  <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': item.progress + '%' }"></div>
                                                </div>
                                              </td>
                                              <td class="text-center">
                                                <span *ngIf="item.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                                                <span *ngIf="item.isCancel"><i class="glyphicon glyphicon-ban-circle"></i></span>
                                                <span *ngIf="item.isError"><i class="glyphicon glyphicon-remove"></i></span>
                                              </td>
                                            <td nowrap>
                                                <ul class="actiongroup">
                                                    <li>
                                                        <button type="button" class="btn btn-success btn-xs" (click)="upload(item.id)" [disabled]="item.isSuccess">
                                                            <span class="glyphicon glyphicon-upload"></span> Upload
                                                        </button>
                                                    </li>
                                                    <li>
                                                        <button type="button" class="btn btn-danger btn-xs" (click)="removeSelected(i)" [disabled]="item.isUploading">
                                                            <span class="glyphicon glyphicon-remove"></span> Remove
                                                        </button>
                                                    </li>
                                                </ul>
                                            </td>
                                            </tr>
                                          </tbody>
                                        </table>
                                        <div class="uploadall">
                                            <div *ngIf="uploadinginprogress">Please wait uploading...</div>
                                          <!-- <div>
                                            Queue progress:
                                            <div class="progress" style="">
                                              <div class="progress-bar" role="progressbar" [ngStyle]="{ 'width': progress + '%' }"></div>
                                            </div>
                                          </div> -->
                                          <!-- <button type="button" class="btn btn-success btn-sm" (click)="uploadAll()" [disabled]="!uploader.queue.length">
                                            <span class="glyphicon glyphicon-upload"></span> Upload all
                                          </button>   -->
                                           
                                          <!-- <button type="button" class="btn btn-danger btn-sm" (click)="removeAll()" [disabled]="!uploader.queue.length">
                                            <span class="glyphicon glyphicon-remove"></span> Remove all
                                          </button> -->
                                    
                                        </div>
                                      </div>
                                </div>
                                    <!-- fileupload ui end -->
                                </div>
                            </div>
                            <ng-template #template>
                                <div class="modal-header">
                                  <h4 class="modal-title pull-left">File size error</h4>
                                  <button type="button" class="close pull-right" aria-label="Close" (click)="bsModalRef.hide()">
                                    <span aria-hidden="true">&times;</span>
                                  </button>
                                </div>
                                <div class="modal-body">
                                  <p>Select image file size seems to be greater than allowed file size.</p>
                                    <p>Maximum allowed image file size is <strong>300 KB</strong>.</p> 
    
                                </div>
                              </ng-template>
                              <ng-template #templateproductimg>
                                    <div class="modal-header">
                                      <h4 class="modal-title pull-left">Error</h4>
                                      <button type="button" class="close pull-right" aria-label="Close" (click)="bsModalRef.hide()">
                                        <span aria-hidden="true">&times;</span>
                                      </button>
                                    </div>
                                    <div class="modal-body">
                                      <p>Please Upload .jpeg/.jpg images ( e.g myproduct.jpg).</p>
                                    </div>
                                  </ng-template>
                                  <ng-template #templatenewaddposted>
                                        <div class="modal-header">
                                          <h4 class="modal-title pull-left">Success</h4>
                                          <button type="button" class="close pull-right" aria-label="Close" (click)="bsModalRef.hide()">
                                            <span aria-hidden="true">&times;</span>
                                          </button>
                                        </div>
                                        <div class="modal-body">
                                          <p>Ad Updated Successfully</p>
                                        </div>
                                      </ng-template>
					</div>
				</div>
      <!-- sidebar -->
      <app-sidebar></app-sidebar>
      <!-- /sidebar-->
			</div>
		</div>
	</div>
	<app-footer></app-footer>
